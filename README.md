# CMakeSTM32CubeMX

A CMakeLists.txt for building STM32 HAL-based projects with FreeRTOS with arm-none-eabi-gcc.

As a source it uses a file tree generated by STM32CubeMX and Makefile toolchain.

Just generate the project and copy this CMakeLists.txt into the project root.
Now you can use any IDE with STM32CubeMX in parralel mode.

Console build:
```
cmake -GNinja -DCMAKE_CXX_COMPILER:STRING=arm-none-eabi-g++ -DCMAKE_C_COMPILER:STRING=arm-none-eabi-gcc -DCMAKE_BUILD_TYPE:STRING=Debug ..
ninja -v
```

CMake configuration for QtCreator and ninja.
QtCreator\Preferences\Kits\Bare Metal\CMake Configuration:
```
CMAKE_CXX_COMPILER:STRING=%{Compiler:Executable:Cxx}
CMAKE_C_COMPILER:STRING=%{Compiler:Executable:C}
CMAKE_MAKE_PROGRAM:INTERNAL=/usr/local/bin/ninja
```

Just a note: To disable write protection (edit target if needed):
```
$ openocd -f interface/stlink-v2.cfg \
          -f target/stm32f1x.cfg \
          -c "init; reset halt; stm32f1x unlock 0; reset halt; exit"
```
